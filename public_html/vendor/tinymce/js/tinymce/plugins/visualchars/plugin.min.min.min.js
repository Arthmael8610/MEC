!function(){var X,M,g,d,Y,h=function(K){var z=K,J=function(){return z};return{get:J,set:function(Q){z=Q},clone:function(){return h(J())}}},R=tinymce.util.Tools.resolve("tinymce.PluginManager"),I=function(z){return{isEnabled:function(){return z.get()}}},G=function(z,J){return z.fire("VisualChars",{state:J})},N={"\xa0":"nbsp","\xad":"shy"},U=function(K,Q){var J,z="";for(J in K){z+=J}return new RegExp("["+z+"]",Q?"g":"")},L=function(K){var z,J="";for(z in K){J&&(J+=","),J+="span.mce-"+K[z]}return J},f={charMap:N,regExp:U(N),regExpGlobal:U(N,!0),selector:L(N),charMapToRegExp:U,charMapToSelector:L},V=function(z){return function(){return z}},B=V(!1),t=V(!0),e=B,C=t,i=function(){return O},O=(d={fold:function(z,J){return z()},is:e,isSome:e,isNone:C,getOr:g=function(z){return z},getOrThunk:M=function(z){return z()},getOrDie:function(z){throw new Error(z||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){return undefined},or:g,orThunk:M,map:i,ap:i,each:function(){},bind:i,flatten:i,exists:e,forall:C,filter:i,equals:X=function(z){return z.isNone()},equals_:X,toArray:function(){return[]},toString:V("none()")},Object.freeze&&Object.freeze(d),d),P=function(J){var K=function(){return J},W=function(){return Q},z=function(Z){return Z(J)},Q={fold:function(Z,ab){return ab(J)},is:function(Z){return J===Z},isSome:C,isNone:e,getOr:K,getOrThunk:K,getOrDie:K,getOrNull:K,getOrUndefined:K,or:W,orThunk:W,map:function(Z){return P(Z(J))},ap:function(Z){return Z.fold(i,function(ab){return P(ab(J))})},each:function(Z){Z(J)},bind:z,flatten:K,exists:z,forall:z,filter:function(Z){return Z(J)?Q:O},equals:function(Z){return Z.is(J)},equals_:function(Z,ab){return Z.fold(e,function(ac){return ab(J,ac)})},toArray:function(){return[J]},toString:function(){return"some("+J+")"}};return Q},b=function(z){return null===z||z===undefined?O:P(z)},p=(Y="function",function(z){return function(K){if(null===K){return"null"}var J=typeof K;return"object"===J&&Array.prototype.isPrototypeOf(K)?"array":"object"===J&&String.prototype.isPrototypeOf(K)?"string":J}(z)===Y}),r=function(K,Q){for(var J=0,z=K.length;J<z;J++){Q(K[J],J,K)}},A=(Array.prototype.slice,p(Array.from)&&Array.from,function(z){if(null===z||z===undefined){throw new Error("Node cannot be null or undefined")}return{dom:V(z)}}),m={fromHtml:function(K,z){var J=(z||document).createElement("div");if(J.innerHTML=K,!J.hasChildNodes()||1<J.childNodes.length){throw console.error("HTML does not have a single root node",K),"HTML must have a single root node"}return A(J.childNodes[0])},fromTag:function(K,z){var J=(z||document).createElement(K);return A(J)},fromText:function(K,z){var J=(z||document).createTextNode(K);return A(J)},fromDom:A,fromPoint:function(K,Q,J){var z=K.dom();return b(z.elementFromPoint(Q,J)).map(A)}},F={ATTRIBUTE:Node.ATTRIBUTE_NODE,CDATA_SECTION:Node.CDATA_SECTION_NODE,COMMENT:Node.COMMENT_NODE,DOCUMENT:Node.DOCUMENT_NODE,DOCUMENT_TYPE:Node.DOCUMENT_TYPE_NODE,DOCUMENT_FRAGMENT:Node.DOCUMENT_FRAGMENT_NODE,ELEMENT:Node.ELEMENT_NODE,TEXT:Node.TEXT_NODE,PROCESSING_INSTRUCTION:Node.PROCESSING_INSTRUCTION_NODE,ENTITY_REFERENCE:Node.ENTITY_REFERENCE_NODE,ENTITY:Node.ENTITY_NODE,NOTATION:Node.NOTATION_NODE},n=function(z){return z.dom().nodeName.toLowerCase()},a=function(z){return z.dom().nodeType},H=function(z){return function(J){return a(J)===z}},x=H(F.ELEMENT),E=H(F.TEXT),T=H(F.DOCUMENT),l={name:n,type:a,value:function(z){return z.dom().nodeValue},isElement:x,isText:E,isDocument:T,isComment:function(z){return a(z)===F.COMMENT||"#comment"===n(z)}},D=function(z){return'<span data-mce-bogus="1" class="mce-'+f.charMap[z]+'">'+z+"</span>"},k=function(K,Q){var J=[],z=function(W,ab){for(var ad=W.length,ac=new Array(ad),Z=0;Z<ad;Z++){var ae=W[Z];ac[Z]=ab(ae,Z,W)}return ac}(K.dom().childNodes,m.fromDom);return r(z,function(W){Q(W)&&(J=J.concat([W])),J=J.concat(k(W,Q))}),J},j={isMatch:function(z){return l.isText(z)&&l.value(z)!==undefined&&f.regExp.test(l.value(z))},filterDescendants:k,findParentElm:function(z,J){for(;z.parentNode;){if(z.parentNode===J){return z}z=z.parentNode}},replaceWithSpans:function(z){return z.replace(f.regExpGlobal,D)}},o=function(J,K){var z,Q,W=j.filterDescendants(m.fromDom(K),j.isMatch);r(W,function(Z){var ab=j.replaceWithSpans(l.value(Z));for(Q=J.dom.create("div",null,ab);z=Q.lastChild;){J.dom.insertAfter(z,Z.dom())}J.dom.remove(Z.dom())})},y=function(z,K){var J=z.dom.select(f.selector,K);r(J,function(Q){z.dom.remove(Q,1)})},v=o,q=y,aa=function(K){var Q=K.getBody(),J=K.selection.getBookmark(),z=j.findParentElm(K.selection.getNode(),Q);z=z!==undefined?z:Q,y(K,z),o(K,z),K.selection.moveToBookmark(J)},u=function(K,W){var J,z=K.getBody(),Q=K.selection;W.set(!W.get()),G(K,W.get()),J=Q.getBookmark(),!0===W.get()?v(K,z):q(K,z),Q.moveToBookmark(J)},S=function(z,J){z.addCommand("mceVisualChars",function(){u(z,J)})},c=tinymce.util.Tools.resolve("tinymce.util.Delay"),w=function(K,J){var z=c.debounce(function(){aa(K)},300);!1!==K.settings.forced_root_block&&K.on("keydown",function(Q){!0===J.get()&&(13===Q.keyCode?aa(K):z())})},s=function(z){return function(K){var J=K.control;z.on("VisualChars",function(Q){J.active(Q.state)})}};R.add("visualchars",function(K){var z,J=h(!1);return S(K,J),(z=K).addButton("visualchars",{active:!1,title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:s(z)}),z.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:s(z),selectable:!0,context:"view",prependToContext:!0}),w(K,J),I(J)})}();