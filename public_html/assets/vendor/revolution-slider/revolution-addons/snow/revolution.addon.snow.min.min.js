var RsSnowAddOn=function(l,m){if(!m){return}if(!m.children(".tp-static-layers").length){var o=document.createElement("div");o.className="tp-static-layers";o.style="pointer-events: none";m[0].appendChild(o)}var i=m[0].opt.snow,n=i.startSlide,p=i.endSlide,k,j;i={selector:".tp-static-layers",dimension:"self",particleMaxPer:parseInt(i.maxNum,10),particlaSize:[parseFloat(i.minSize),parseFloat(i.maxSize)],particleOpacity:[parseFloat(i.minOpacity),parseFloat(i.maxOpacity)],particleSpeed:[parseInt(i.minSpeed,10),parseInt(i.maxSpeed,10)],particleSinus:[parseInt(i.minSinus,10),parseInt(i.maxSinus,10)]};m.on("revolution.slide.onchange",function(b,a){var c=a.slideIndex;if(n==="first"){n=1}if(p==="last"){p=m.revmaxslide()}if(c>=n&&c<=p){if(!j){m.letItSnow(i);j=true}else{if(!k){m.letItSnow("winter")}}k=true}else{if(j){m.letItSnow("summer");k=false}}})};(function(i,l){function a(b){b.pause=!0,b.sc.find(".snowflakes_wrapper").remove(),b.c.removeData("snowflakes"),b={}}function e(c){c.snowflakes=[];for(var b=c.w*c.h/1500000;c.snowflakes.length<c.particleMaxPer*b;){c.snowflakes.push(n(c))}}function m(b){window.requestAnimationFrame(function(){k(b)})}function k(j){if(j==l||j.ctx==l||1==j.destroyed||1==j.pause){return !1}j.ctx.clearRect(0,0,2700,2500);var b=j.h/3,d=j.h/3*2;for(var o in j.snowflakes){if(j.snowflakes[o].y+0.1*j.snowflakes[o].r<0&&1==j.summer||j.snowflakes[o].y>j.h+j.snowflakes[o].r&&1==j.summer){}else{j.snowflakes[o].delta+=j.snowflakes[o].delta==Math.PI/2?-j.snowflakes[o].delta:Math.random()/500-0.01,j.summer?j.snowflakes[o].y+=j.snowflakes[o].speed/50+0.1*j.snowflakes[o].r:j.snowflakes[o].y+=j.snowflakes[o].speed/100+0.1*j.snowflakes[o].r,j.snowflakes[o].x+=Math.sin(j.snowflakes[o].delta)*(0.1*j.snowflakes[o].r),j.snowflakes[o].y>j.h+j.snowflakes[o].r&&1!=j.summer&&(j.snowflakes[o]=n(j),j.snowflakes[o].y=0-j.snowflakes[o].r);var c=j.snowflakes[o].y-b,h=j.snowflakes[o].r,g=j.snowflakes[o].alpha;if(c>0||1==j.summer){var f=1-c/d;h=j.snowflakes[o].r*f,g=j.snowflakes[o].alpha*f}h=0.1>h?0.1:h,g=0.1>g?0.1:g,j.snowflakes[o].x=j.snowflakes[o].x>j.w+j.snowflakes[o].r?0:j.snowflakes[o].x<-h?j.w:j.snowflakes[o].x,j.ctx.beginPath(),j.ctx.arc(j.snowflakes[o].x,j.snowflakes[o].y,h,2*Math.PI,!1),j.ctx.fillStyle="rgba(255,255,255,"+g+")",j.ctx.fill()}}m(j)}function n(c){var b=new Object;return b.delta=(c.particleSinus[0]+Math.random()*(c.particleSinus[1]-c.particleSinus[0]))*Math.round(2*Math.random()-1),b.r=c.particlaSize[0]+Math.random()*(c.particlaSize[1]-c.particlaSize[0]),b.alpha=c.particleOpacity[0]+Math.random()*(c.particleOpacity[1]-c.particleOpacity[0]),b.speed=(c.particleSpeed[0]+Math.random()*(c.particleSpeed[1]-c.particleSpeed[0]))*b.r/3,b.x=Math.random()*c.w,b.y=Math.random()*-c.h,b}i.fn.extend({letItSnow:function(c){var b={particleMaxPer:400,particlaSize:[0.2,6],particleOpacity:[0.3,1],particleSpeed:[30,100],particleSinus:[1,100]};return"destroy"!=c&&"stop"!=c&&"play"!=c&&"summer"!=c&&"winter"!=c&&(c=i.extend(!0,{},b,c)),this.each(function(){if(-1!=i.inArray(c,["destroy","stop","play","winter","summer"])){switch(c){case"destroy":c=i(this).data("snowflakes"),c!=l&&a(c);break;case"stop":c=i(this).data("snowflakes"),c!=l&&(c.pause=!0);break;case"play":c=i(this).data("snowflakes"),c!=l&&(c.pause=!1,m(c));break;case"summer":c=i(this).data("snowflakes"),c!=l&&(c.summer=!0);break;case"winter":c=i(this).data("snowflakes"),c!=l&&(c.summer=!1)}return !1}return c.c=i(this),c.sc=c.selector!=l?i(this).find(c.selector):c.c,0==c.sc.length?!1:c.c.data("snowflakes")!=l?!1:(c.sc.find(".snowflakes_wrapper").remove(),c.sc.append('<div class="snowflakes_wrapper" style="position:relative;z-index:0"><div class="snowflakes_wrapper_inner" style="overflow:hidden;position:relative"><canvas width="2700" height="2500" style="position:relative;" class="snowflake_canvas"></canvas></div></div>'),c.sw=c.sc.find(".snowflakes_wrapper_inner"),c.sw.data("caller_container",c.c),c.canvas=c.sc.find(".snowflake_canvas"),c.dimension!=self?c.sizer=c.c:c.sizer=c.sc,c.w=c.sizer.width(),c.h=c.sizer.height(),c.sc.find(".snowflakes_wrapper_inner").css({width:c.w,height:c.h}),c.canvas=c.canvas[0],c.snowflakes=[],c.ctx=c.canvas.getContext("2d"),e(c),m(c),c.c.data("snowflakes",c),void i(window).resize(function(){clearTimeout(c.timer),c.timer=setTimeout(function(){c.w=c.sizer.width(),c.h=c.sizer.height(),c.sc.find(".snowflakes_wrapper_inner").css({width:c.w,height:c.h}),e(c)},50)}))})}})})(jQuery);