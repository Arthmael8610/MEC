(function(c){var a=c.document;if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}function d(e){this.el=e;this.overlay=this.el.querySelector(".nl-overlay");this.fields=[];this.fldOpen=-1;this._init()}d.prototype={_init:function(){var e=this;Array.prototype.slice.call(this.el.querySelectorAll("select")).forEach(function(g,f){e.fldOpen++;e.fields.push(new b(e,g,"dropdown",e.fldOpen))});Array.prototype.slice.call(this.el.querySelectorAll("input")).forEach(function(g,f){e.fldOpen++;e.fields.push(new b(e,g,"input",e.fldOpen))});this.overlay.addEventListener("click",function(f){e._closeFlds()});this.overlay.addEventListener("touchstart",function(f){e._closeFlds()})},_closeFlds:function(){if(this.fldOpen!==-1){this.fields[this.fldOpen].close()}}};function b(h,g,f,e){this.form=h;this.elOriginal=g;this.pos=e;this.type=f;this._create();this._initEvents()}b.prototype={_create:function(){if(this.type==="dropdown"){this._createDropDown()}else{if(this.type==="input"){this._createInput()}}},_createDropDown:function(){var e=this;this.fld=a.createElement("div");this.fld.className="nl-field nl-dd";this.toggle=a.createElement("a");this.toggle.innerHTML=this.elOriginal.options[this.elOriginal.selectedIndex].innerHTML;this.toggle.className="nl-field-toggle";this.optionsList=a.createElement("ul");var f="";Array.prototype.slice.call(this.elOriginal.querySelectorAll("option")).forEach(function(h,g){f+=e.elOriginal.selectedIndex===g?'<li class="nl-dd-checked">'+h.innerHTML+"</li>":"<li>"+h.innerHTML+"</li>";if(e.elOriginal.selectedIndex===g){e.selectedIdx=g}});this.optionsList.innerHTML=f;this.fld.appendChild(this.toggle);this.fld.appendChild(this.optionsList);this.elOriginal.parentNode.insertBefore(this.fld,this.elOriginal);this.elOriginal.style.display="none"},_createInput:function(){var e=this;this.fld=a.createElement("div");this.fld.className="nl-field nl-ti-text";this.toggle=a.createElement("a");this.toggle.innerHTML=this.elOriginal.getAttribute("placeholder");this.toggle.className="nl-field-toggle";this.optionsList=a.createElement("ul");this.getinput=a.createElement("input");this.getinput.setAttribute("type","text");this.getinput.setAttribute("placeholder",this.elOriginal.getAttribute("placeholder"));this.getinputWrapper=a.createElement("li");this.getinputWrapper.className="nl-ti-input";this.inputsubmit=a.createElement("button");this.inputsubmit.className="nl-field-go";this.inputsubmit.innerHTML="Go";this.getinputWrapper.appendChild(this.getinput);this.getinputWrapper.appendChild(this.inputsubmit);this.example=a.createElement("li");this.example.className="nl-ti-example";this.example.innerHTML=this.elOriginal.getAttribute("data-subline");this.optionsList.appendChild(this.getinputWrapper);this.optionsList.appendChild(this.example);this.fld.appendChild(this.toggle);this.fld.appendChild(this.optionsList);this.elOriginal.parentNode.insertBefore(this.fld,this.elOriginal);this.elOriginal.style.display="none"},_initEvents:function(){var e=this;this.toggle.addEventListener("click",function(g){g.preventDefault();g.stopPropagation();e._open()});this.toggle.addEventListener("touchstart",function(g){g.preventDefault();g.stopPropagation();e._open()});if(this.type==="dropdown"){var f=Array.prototype.slice.call(this.optionsList.querySelectorAll("li"));f.forEach(function(h,g){h.addEventListener("click",function(i){i.preventDefault();e.close(h,f.indexOf(h))});h.addEventListener("touchstart",function(i){i.preventDefault();e.close(h,f.indexOf(h))})})}else{if(this.type==="input"){this.getinput.addEventListener("keydown",function(g){if(g.keyCode==13){e.close()}});this.inputsubmit.addEventListener("click",function(g){g.preventDefault();e.close()});this.inputsubmit.addEventListener("touchstart",function(g){g.preventDefault();e.close()})}}},_open:function(){if(this.open){return false}this.open=true;this.form.fldOpen=this.pos;var e=this;this.fld.className+=" nl-field-open"},close:function(f,e){if(!this.open){return false}this.open=false;this.form.fldOpen=-1;this.fld.className=this.fld.className.replace(/\b nl-field-open\b/,"");if(this.type==="dropdown"){if(f){var g=this.optionsList.children[this.selectedIdx];g.className="";f.className="nl-dd-checked";this.toggle.innerHTML=f.innerHTML;this.selectedIdx=e;this.elOriginal.value=this.elOriginal.children[this.selectedIdx].value}}else{if(this.type==="input"){this.getinput.blur();this.toggle.innerHTML=this.getinput.value.trim()!==""?this.getinput.value:this.getinput.getAttribute("placeholder");this.elOriginal.value=this.getinput.value}}}};c.NLForm=d})(window);