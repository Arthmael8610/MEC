(function(){if(typeof self==="undefined"||!self.Prism||!self.document||!document.createRange){return}Prism.plugins.KeepMarkup=true;Prism.hooks.add("before-highlight",function(f){if(!f.element.children.length){return}var g=0;var h=[];var e=function(i,c){var b={};if(!c){b.clone=i.cloneNode(false);b.posOpen=g;h.push(b)}for(var d=0,l=i.childNodes.length;d<l;d++){var a=i.childNodes[d];if(a.nodeType===1){e(a)}else{if(a.nodeType===3){g+=a.data.length}}}if(!c){b.posClose=g}};e(f.element,true);if(h&&h.length){f.keepMarkup=h}});Prism.hooks.add("after-highlight",function(c){if(c.keepMarkup&&c.keepMarkup.length){var d=function(i,j){for(var b=0,l=i.childNodes.length;b<l;b++){var a=i.childNodes[b];if(a.nodeType===1){if(!d(a,j)){return false}}else{if(a.nodeType===3){if(!j.nodeStart&&j.pos+a.data.length>j.node.posOpen){j.nodeStart=a;j.nodeStartPos=j.node.posOpen-j.pos}if(j.nodeStart&&j.pos+a.data.length>=j.node.posClose){j.nodeEnd=a;j.nodeEndPos=j.node.posClose-j.pos}j.pos+=a.data.length}}if(j.nodeStart&&j.nodeEnd){var k=document.createRange();k.setStart(j.nodeStart,j.nodeStartPos);k.setEnd(j.nodeEnd,j.nodeEndPos);j.node.clone.appendChild(k.extractContents());k.insertNode(j.node.clone);k.detach();return false}}return true};c.keepMarkup.forEach(function(a){d(c.element,{node:a,pos:0})})}})}());