describe("Drawing HTML overlays",function(){var b,a;beforeEach(function(){b=b||new GMaps({el:"#map-with-overlays",lat:-12.0433,lng:-77.0283,zoom:12});a=a||b.drawOverlay({lat:b.getCenter().lat(),lng:b.getCenter().lng(),layer:"overlayLayer",content:'<div class="overlay">Lima</div>',verticalAlign:"top",horizontalAlign:"center"})});it("should add the overlay to the overlays collection",function(){expect(b.overlays.length).toEqual(1);expect(b.overlays[0]).toEqual(a)});it("should add the overlay in the current map",function(){expect(a.getMap()).toEqual(b.map)});describe("With events",function(){var d,c;beforeEach(function(){d={onclick:function(){console.log("Clicked the overlay")}};spyOn(d,"onclick").and.callThrough();c=b.drawOverlay({lat:b.getCenter().lat(),lng:b.getCenter().lng(),content:"<p>Clickable overlay</p>",click:d.onclick})});it("should respond to click event",function(e){google.maps.event.addListenerOnce(c,"ready",function(){google.maps.event.trigger(c.el,"click");expect(d.onclick).toHaveBeenCalled();e()})})})});