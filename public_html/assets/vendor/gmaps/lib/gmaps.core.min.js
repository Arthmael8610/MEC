var extend_object=function(b,c){var a;if(b===c){return b}for(a in c){if(c[a]!==undefined){b[a]=c[a]}}return b};var replace_object=function(c,b){var a;if(c===b){return c}for(a in b){if(c[a]!=undefined){c[a]=b[a]}}return c};var array_map=function(f,e){var b=Array.prototype.slice.call(arguments,2),d=[],a=f.length,c;if(Array.prototype.map&&f.map===Array.prototype.map){d=Array.prototype.map.call(f,function(h){var g=b.slice(0);g.splice(0,0,h);return e.apply(this,g)})}else{for(c=0;c<a;c++){callback_params=b;callback_params.splice(0,0,f[c]);d.push(e.apply(this,callback_params))}}return d};var array_flat=function(c){var b=[],a;for(a=0;a<c.length;a++){b=b.concat(c[a])}return b};var coordsToLatLngs=function(b,c){var d=b[0],a=b[1];if(c){d=b[1];a=b[0]}return new google.maps.LatLng(d,a)};var arrayToLatLng=function(b,c){var a;for(a=0;a<b.length;a++){if(!(b[a] instanceof google.maps.LatLng)){if(b[a].length>0&&typeof(b[a][0])==="object"){b[a]=arrayToLatLng(b[a],c)}else{b[a]=coordsToLatLngs(b[a],c)}}}return b};var getElementsByClassName=function(d,c){var b,a=d.replace(".","");if("jQuery" in this&&c){b=$("."+a,c)[0]}else{b=document.getElementsByClassName(a)[0]}return b};var getElementById=function(c,b){var a,c=c.replace("#","");if("jQuery" in window&&b){a=$("#"+c,b)[0]}else{a=document.getElementById(c)}return a};var findAbsolutePosition=function(c){var f=0,b=0;if(c.getBoundingClientRect){var a=c.getBoundingClientRect();var e=-(window.scrollX?window.scrollX:window.pageXOffset);var d=-(window.scrollY?window.scrollY:window.pageYOffset);return[(a.left-e),(a.top-d)]}if(c.offsetParent){do{f+=c.offsetLeft;b+=c.offsetTop}while(c=c.offsetParent)}return[f,b]};var GMaps=(function(b){var c=document;var a=function(k){if(!(typeof window.google==="object"&&window.google.maps)){if(typeof window.console==="object"&&window.console.error){console.error("Google Maps API is required. Please register the following JavaScript library https://maps.googleapis.com/maps/api/js.")}return function(){}}if(!this){return new a(k)}k.zoom=k.zoom||15;k.mapType=k.mapType||"roadmap";var x=function(H,i){return H===undefined?i:H};var A=this,C,m=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],q=["mousemove","mouseout","mouseover"],s=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],h=k.el||k.div,o=k.markerClusterer,D=google.maps.MapTypeId[k.mapType.toUpperCase()],y=new google.maps.LatLng(k.lat,k.lng),G=x(k.zoomControl,true),e=k.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},B=e.style||"DEFAULT",f=e.position||"TOP_LEFT",t=x(k.panControl,true),n=x(k.mapTypeControl,true),r=x(k.scaleControl,true),p=x(k.streetViewControl,true),l=x(l,true),z={},v={zoom:this.zoom,center:y,mapTypeId:D},d={panControl:t,zoomControl:G,zoomControlOptions:{style:google.maps.ZoomControlStyle[B],position:google.maps.ControlPosition[f]},mapTypeControl:n,scaleControl:r,streetViewControl:p,overviewMapControl:l};if(typeof(k.el)==="string"||typeof(k.div)==="string"){if(h.indexOf("#")>-1){this.el=getElementById(h,k.context)}else{this.el=getElementsByClassName.apply(this,[h,k.context])}}else{this.el=h}if(typeof(this.el)==="undefined"||this.el===null){throw"No element defined."}window.context_menu=window.context_menu||{};window.context_menu[A.el.id]={};this.controls=[];this.overlays=[];this.layers=[];this.singleLayers={};this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.infoWindow=null;this.overlay_el=null;this.zoom=k.zoom;this.registered_events={};this.el.style.width=k.width||this.el.scrollWidth||this.el.offsetWidth;this.el.style.height=k.height||this.el.scrollHeight||this.el.offsetHeight;google.maps.visualRefresh=k.enableNewStyle;for(C=0;C<s.length;C++){delete k[s[C]]}if(k.disableDefaultUI!=true){v=extend_object(v,d)}z=extend_object(v,k);for(C=0;C<m.length;C++){delete z[m[C]]}for(C=0;C<q.length;C++){delete z[q[C]]}this.map=new google.maps.Map(this.el,z);if(o){this.markerClusterer=o.apply(this,[this.map])}var u=function(L,Q){var P="",U=window.context_menu[A.el.id][L];for(var M in U){if(U.hasOwnProperty(M)){var O=U[M];P+='<li><a id="'+L+"_"+M+'" href="#">'+O.title+"</a></li>"}}if(!getElementById("gmaps_context_menu")){return}var R=getElementById("gmaps_context_menu");R.innerHTML=P;var H=R.getElementsByTagName("a"),T=H.length,M;for(M=0;M<T;M++){var J=H[M];var K=function(i){i.preventDefault();U[this.id.replace(L+"_","")].action.apply(A,[Q]);A.hideContextMenu()};google.maps.event.clearListeners(J,"click");google.maps.event.addDomListenerOnce(J,"click",K,false)}var N=findAbsolutePosition.apply(this,[A.el]),I=N[0]+Q.pixel.x-15,S=N[1]+Q.pixel.y-15;R.style.left=I+"px";R.style.top=S+"px"};this.buildContextMenu=function(I,H){if(I==="marker"){H.pixel={};var i=new google.maps.OverlayView();i.setMap(A.map);i.draw=function(){var L=i.getProjection(),K=H.marker.getPosition();H.pixel=L.fromLatLngToContainerPixel(K);u(I,H)}}else{u(I,H)}var J=getElementById("gmaps_context_menu");setTimeout(function(){J.style.display="block"},0)};this.setContextMenu=function(H){window.context_menu[A.el.id][H.control]={};var J,I=c.createElement("ul");for(J in H.options){if(H.options.hasOwnProperty(J)){var K=H.options[J];window.context_menu[A.el.id][H.control][K.name]={title:K.title,action:K.action}}}I.id="gmaps_context_menu";I.style.display="none";I.style.position="absolute";I.style.minWidth="100px";I.style.background="white";I.style.listStyle="none";I.style.padding="8px";I.style.boxShadow="2px 2px 6px #ccc";if(!getElementById("gmaps_context_menu")){c.body.appendChild(I)}var L=getElementById("gmaps_context_menu");google.maps.event.addDomListener(L,"mouseout",function(i){if(!i.relatedTarget||!this.contains(i.relatedTarget)){window.setTimeout(function(){L.style.display="none"},400)}},false)};this.hideContextMenu=function(){var i=getElementById("gmaps_context_menu");if(i){i.style.display="none"}};var w=function(H,i){google.maps.event.addListener(H,i,function(I){if(I==undefined){I=this}k[i].apply(this,[I]);A.hideContextMenu()})};google.maps.event.addListener(this.map,"zoom_changed",this.hideContextMenu);for(var E=0;E<m.length;E++){var F=m[E];if(F in k){w(this.map,F)}}for(var E=0;E<q.length;E++){var F=q[E];if(F in k){w(this.map,F)}}google.maps.event.addListener(this.map,"rightclick",function(i){if(k.rightclick){k.rightclick.apply(this,[i])}if(window.context_menu[A.el.id]["map"]!=undefined){A.buildContextMenu("map",i)}});this.refresh=function(){google.maps.event.trigger(this.map,"resize")};this.fitZoom=function(){var J=[],H=this.markers.length,I;for(I=0;I<H;I++){if(typeof(this.markers[I].visible)==="boolean"&&this.markers[I].visible){J.push(this.markers[I].getPosition())}}this.fitLatLngBounds(J)};this.fitLatLngBounds=function(K){var J=K.length,I=new google.maps.LatLngBounds(),H;for(H=0;H<J;H++){I.extend(K[H])}this.map.fitBounds(I)};this.setCenter=function(H,i,I){this.map.panTo(new google.maps.LatLng(H,i));if(I){I()}};this.getElement=function(){return this.el};this.zoomIn=function(i){i=i||1;this.zoom=this.map.getZoom()+i;this.map.setZoom(this.zoom)};this.zoomOut=function(i){i=i||1;this.zoom=this.map.getZoom()-i;this.map.setZoom(this.zoom)};var j=[],g;for(g in this.map){if(typeof(this.map[g])=="function"&&!this[g]){j.push(g)}}for(C=0;C<j.length;C++){(function(i,I,H){i[H]=function(){return I[H].apply(I,arguments)}})(this,this.map,j[C])}};return a})(this);