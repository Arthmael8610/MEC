(function(b){window.MSVideoLayerElement=function(){MSLayerElement.call(this);this.__cssConfig.push("height");this.type="video"};MSVideoLayerElement.extend(MSLayerElement);var c=MSVideoLayerElement.prototype;var a=MSLayerElement.prototype;c.__playVideo=function(){if(this.img){CTween.fadeOut(this.img,500,2)}CTween.fadeOut(this.video_btn,500,2);this.video_frame.attr("src","about:blank").css("display","block");if(this.video_url.indexOf("?")==-1){this.video_url+="?"}this.video_frame.attr("src",this.video_url+"&autoplay=1")};c.start=function(){a.start.call(this);if(this.$element.data("autoplay")){this.__playVideo()}};c.reset=function(){a.reset.call(this);if(this.needPreload||this.$element.data("btn")){this.video_btn.css("opacity",1).css("display","block");this.video_frame.attr("src","about:blank").css("display","none")}if(this.needPreload){this.img.css("opacity",1).css("display","block");return}this.video_frame.attr("src",this.video_url)};c.create=function(){a.create.call(this);this.video_frame=this.$element.find("iframe").css({width:"100%",height:"100%"});this.video_url=this.video_frame.attr("src");var d=this.$element.has("img").length!=0;if(!d&&!this.$element.data("btn")){return}this.video_frame.attr("src","about:blank").css("display","none");var e=this;this.video_btn=b("<div></div>").appendTo(this.$element).addClass("ms-video-btn").click(function(){e.__playVideo()});if(!d){return}this.needPreload=true;this.img=this.$element.find("img:first").addClass("ms-video-img");if(this.img.data("src")!==undefined){this.img_src=this.img.data("src");this.img.removeAttr("data-src")}else{var e=this;this.img.attr("src",this.img_src).on("load",function(f){e.controller.preloadCount--;if(e.controller.preloadCount===0){e.controller._onlayersReady()}}).each(b.jqLoadFix)}if(b.browser.msie){this.img.on("dragstart",function(f){f.preventDefault()})}};c.loadImage=function(){var d=this;this.img.preloadImg(this.img_src,function(e){d.controller.preloadCount--;if(d.controller.preloadCount===0){d.controller._onlayersReady()}})}})(jQuery);