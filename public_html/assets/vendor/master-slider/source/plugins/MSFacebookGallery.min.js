(function(a){window.MSFacebookGallery=function(h,f){var e={count:10,type:"photostream",thumbSize:"320",imgSize:"orginal",https:false,token:""};this.slider=h;this.slider.holdOn();a.extend(e,f);this.options=e;this.graph="https://graph.facebook.com";var g=this;if(this.options.type==="photostream"){a.getJSON(this.graph+"/"+this.options.username+"/photos/uploaded/?fields=source,name,link,images,from&limit="+this.options.count+"&access_token="+this.options.token,function(i){g._photosData(i)})}else{a.getJSON(this.graph+"/"+this.options.albumId+"/photos?fields=source,name,link,images,from&limit="+this.options.count+"&access_token="+this.options.token,function(i){g._photosData(i)})}this.slideTemplate=this.slider.$element.find(".ms-slide")[0].outerHTML;this.slider.$element.find(".ms-slide").remove()};var b=MSFacebookGallery.prototype;b._photosData=function(j){if(j.error){this.errMsg("Facebook API ERROR#"+j.error.code+"("+j.error.type+"): "+j.error.message);return}var h=this;var f=this.options.author||this.options.desc;for(var g=0,e=j.data.length;g!==e;g++){var k=h.slideTemplate.replace(/{{[\w-]+}}/g,function(i){i=i.replace(/{{|}}/g,"");if(d[i]){return d[i](j.data[g],h)}else{return"{{"+i+"}}"}});a(k).appendTo(h.slider.$element)}h._initSlider()};b.errMsg=function(e){this.slider.$element.css("display","block");if(!this.errEle){this.errEle=a('<div style="font-family:Arial; color:red; font-size:12px; position:absolute; top:10px; left:10px"></div>').appendTo(this.slider.$loading)}this.errEle.html(e)};b._initSlider=function(){this.slider.release()};var c=function(e,h){if(h==="orginal"){return e[0].source}for(var g=0,f=e.length;g!==f;g++){if(e[g].source.indexOf(h+"x"+h)!==-1){return e[g].source}}return e[0].source};var d={image:function(f,e){return c(f.images,e.options.imgSize)},thumb:function(f,e){return c(f.images,e.options.thumbSize)},name:function(f,e){return f.name},"owner-name":function(f,e){return f.from.name},link:function(f,e){return f.link}}})(jQuery);