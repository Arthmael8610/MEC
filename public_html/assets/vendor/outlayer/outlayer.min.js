/*!
 * Outlayer v2.1.1
 * the brains and guts of a layout library
 * MIT license
 */
(function(b,a){if(typeof define=="function"&&define.amd){define(["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(c,f,d,e){return a(b,c,f,d,e)})}else{if(typeof module=="object"&&module.exports){module.exports=a(b,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item"))}else{b.Outlayer=a(b,b.EvEmitter,b.getSize,b.fizzyUIUtils,b.Outlayer.Item)}}}(window,function factory(i,b,n,l,d){var e=i.console;var o=i.jQuery;var m=function(){};var h=0;var a={};function g(s,q){var p=l.getQueryElement(s);if(!p){if(e){e.error("Bad element for "+this.constructor.namespace+": "+(p||s))}return}this.element=p;if(o){this.$element=o(this.element)}this.options=l.extend({},this.constructor.defaults);this.option(q);var t=++h;this.element.outlayerGUID=t;a[t]=this;this._create();var r=this._getOption("initLayout");if(r){this.layout()}}g.namespace="outlayer";g.Item=d;g.defaults={containerStyle:{position:"relative"},initLayout:true,originLeft:true,originTop:true,resize:true,resizeContainer:true,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var f=g.prototype;l.extend(f,b.prototype);f.option=function(p){l.extend(this.options,p)};f._getOption=function(q){var p=this.constructor.compatOptions[q];return p&&this.options[p]!==undefined?this.options[p]:this.options[q]};g.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"};f._create=function(){this.reloadItems();this.stamps=[];this.stamp(this.options.stamp);l.extend(this.element.style,this.options.containerStyle);var p=this._getOption("resize");if(p){this.bindResize()}};f.reloadItems=function(){this.items=this._itemize(this.element.children)};f._itemize=function(q){var t=this._filterFindItemElements(q);var r=this.constructor.Item;var p=[];for(var s=0;s<t.length;s++){var v=t[s];var u=new r(v,this);p.push(u)}return p};f._filterFindItemElements=function(p){return l.filterFindElements(p,this.options.itemSelector)};f.getItemElements=function(){return this.items.map(function(p){return p.element})};f.layout=function(){this._resetLayout();this._manageStamps();var p=this._getOption("layoutInstant");var q=p!==undefined?p:!this._isLayoutInited;this.layoutItems(this.items,q);this._isLayoutInited=true};f._init=f.layout;f._resetLayout=function(){this.getSize()};f.getSize=function(){this.size=n(this.element)};f._getMeasurement=function(r,p){var q=this.options[r];var s;if(!q){this[r]=0}else{if(typeof q=="string"){s=this.element.querySelector(q)}else{if(q instanceof HTMLElement){s=q}}this[r]=s?n(s)[p]:q}};f.layoutItems=function(p,q){p=this._getItemsForLayout(p);this._layoutItems(p,q);this._postLayout()};f._getItemsForLayout=function(p){return p.filter(function(q){return !q.isIgnored})};f._layoutItems=function(q,r){this._emitCompleteOnItems("layout",q);if(!q||!q.length){return}var p=[];q.forEach(function(t){var s=this._getItemLayoutPosition(t);s.item=t;s.isInstant=r||t.isLayoutInstant;p.push(s)},this);this._processLayoutQueue(p)};f._getItemLayoutPosition=function(){return{x:0,y:0}};f._processLayoutQueue=function(p){this.updateStagger();p.forEach(function(r,q){this._positionItem(r.item,r.x,r.y,r.isInstant,q)},this)};f.updateStagger=function(){var p=this.options.stagger;if(p===null||p===undefined){this.stagger=0;return}this.stagger=j(p);return this.stagger};f._positionItem=function(r,p,t,s,q){if(s){r.goTo(p,t)}else{r.stagger(q*this.stagger);r.moveTo(p,t)}};f._postLayout=function(){this.resizeContainer()};f.resizeContainer=function(){var q=this._getOption("resizeContainer");if(!q){return}var p=this._getContainerSize();if(p){this._setContainerMeasure(p.width,true);this._setContainerMeasure(p.height,false)}};f._getContainerSize=m;f._setContainerMeasure=function(p,q){if(p===undefined){return}var r=this.size;if(r.isBorderBox){p+=q?r.paddingLeft+r.paddingRight+r.borderLeftWidth+r.borderRightWidth:r.paddingBottom+r.paddingTop+r.borderTopWidth+r.borderBottomWidth}p=Math.max(p,0);this.element.style[q?"width":"height"]=p+"px"};f._emitCompleteOnItems=function(q,p){var v=this;function u(){v.dispatchEvent(q+"Complete",null,[p])}var t=p.length;if(!p||!t){u();return}var r=0;function s(){r++;if(r==t){u()}}p.forEach(function(w){w.once(q,s)})};f.dispatchEvent=function(s,t,q){var r=t?[t].concat(q):q;this.emitEvent(s,r);if(o){this.$element=this.$element||o(this.element);if(t){var p=o.Event(t);p.type=s;this.$element.trigger(p,q)}else{this.$element.trigger(s,q)}}};f.ignore=function(q){var p=this.getItem(q);if(p){p.isIgnored=true}};f.unignore=function(q){var p=this.getItem(q);if(p){delete p.isIgnored}};f.stamp=function(p){p=this._find(p);if(!p){return}this.stamps=this.stamps.concat(p);p.forEach(this.ignore,this)};f.unstamp=function(p){p=this._find(p);if(!p){return}p.forEach(function(q){l.removeFrom(this.stamps,q);this.unignore(q)},this)};f._find=function(p){if(!p){return}if(typeof p=="string"){p=this.element.querySelectorAll(p)}p=l.makeArray(p);return p};f._manageStamps=function(){if(!this.stamps||!this.stamps.length){return}this._getBoundingRect();this.stamps.forEach(this._manageStamp,this)};f._getBoundingRect=function(){var p=this.element.getBoundingClientRect();var q=this.size;this._boundingRect={left:p.left+q.paddingLeft+q.borderLeftWidth,top:p.top+q.paddingTop+q.borderTopWidth,right:p.right-(q.paddingRight+q.borderRightWidth),bottom:p.bottom-(q.paddingBottom+q.borderBottomWidth)}};f._manageStamp=m;f._getElementOffset=function(s){var p=s.getBoundingClientRect();var r=this._boundingRect;var q=n(s);var t={left:p.left-r.left-q.marginLeft,top:p.top-r.top-q.marginTop,right:r.right-p.right-q.marginRight,bottom:r.bottom-p.bottom-q.marginBottom};return t};f.handleEvent=l.handleEvent;f.bindResize=function(){i.addEventListener("resize",this);this.isResizeBound=true};f.unbindResize=function(){i.removeEventListener("resize",this);this.isResizeBound=false};f.onresize=function(){this.resize()};l.debounceMethod(g,"onresize",100);f.resize=function(){if(!this.isResizeBound||!this.needsResizeLayout()){return}this.layout()};f.needsResizeLayout=function(){var q=n(this.element);var p=this.size&&q;return p&&q.innerWidth!==this.size.innerWidth};f.addItems=function(q){var p=this._itemize(q);if(p.length){this.items=this.items.concat(p)}return p};f.appended=function(q){var p=this.addItems(q);if(!p.length){return}this.layoutItems(p,true);this.reveal(p)};f.prepended=function(q){var p=this._itemize(q);if(!p.length){return}var r=this.items.slice(0);this.items=p.concat(r);this._resetLayout();this._manageStamps();this.layoutItems(p,true);this.reveal(p);this.layoutItems(r)};f.reveal=function(p){this._emitCompleteOnItems("reveal",p);if(!p||!p.length){return}var q=this.updateStagger();p.forEach(function(s,r){s.stagger(r*q);s.reveal()})};f.hide=function(p){this._emitCompleteOnItems("hide",p);if(!p||!p.length){return}var q=this.updateStagger();p.forEach(function(s,r){s.stagger(r*q);s.hide()})};f.revealItemElements=function(q){var p=this.getItems(q);this.reveal(p)};f.hideItemElements=function(q){var p=this.getItems(q);this.hide(p)};f.getItem=function(r){for(var p=0;p<this.items.length;p++){var q=this.items[p];if(q.element==r){return q}}};f.getItems=function(q){q=l.makeArray(q);var p=[];q.forEach(function(s){var r=this.getItem(s);if(r){p.push(r)}},this);return p};f.remove=function(p){var q=this.getItems(p);this._emitCompleteOnItems("remove",q);if(!q||!q.length){return}q.forEach(function(r){r.remove();l.removeFrom(this.items,r)},this)};f.destroy=function(){var p=this.element.style;p.height="";p.position="";p.width="";this.items.forEach(function(r){r.destroy()});this.unbindResize();var q=this.element.outlayerGUID;delete a[q];delete this.element.outlayerGUID;if(o){o.removeData(this.element,this.constructor.namespace)}};g.data=function(p){p=l.getQueryElement(p);var q=p&&p.outlayerGUID;return q&&a[q]};g.create=function(r,p){var q=c(g);q.defaults=l.extend({},g.defaults);l.extend(q.defaults,p);q.compatOptions=l.extend({},g.compatOptions);q.namespace=r;q.data=g.data;q.Item=c(d);l.htmlInit(q,r);if(o&&o.bridget){o.bridget(r,q)}return q};function c(p){function q(){p.apply(this,arguments)}q.prototype=Object.create(p.prototype);q.prototype.constructor=q;return q}var k={ms:1,s:1000};function j(t){if(typeof t=="number"){return t}var r=t.match(/(^\d*\.?\d*)(\w*)/);var p=r&&r[1];var q=r&&r[2];if(!p.length){return 0}p=parseFloat(p);var s=k[q]||1;return p*s}g.Item=d;return g}));